PROGRAM Test16
	IMPLICIT NONE
	INTEGER :: i,j,k
	REAL :: start,finish,tresults(15)
	do k = 1,15
		CALL cpu_time(start)
		
		CALL cpu_time(finish)
		tresults(k) = finish - start
	end do
	WRITE(*,*) sum(tresults)/15
END PROGRAM Test16

subroutine runSA(nParams,lowerBounds,upperBounds,energyFnc,neighFnc,ret)
	 REAL, INTENT(INOUT) :: nParams,lowerBounds,upperBounds,energyFnc,neighFnc 
	 REAL :: cooling_sched,maxIters,stopTemp,eMin,iterationIndicator, xVec(2)
	 REAL :: eNew,eBest,e,k,T
	 REAL, INTENT(OUT) :: ret(3)  
	 cooling_sched = 0.999
	 maxIters = 1e30
	 stopTemp = 1e-30
	 eMin = 0.001
	 iterationIndicator = 1000
	 xVec = neighFnc(nParams,lowerBounds,upperBounds)
	 eBest = energyFnc(xVec)
	 e = eBest;
	 k = 1
	 T = 1

	 do while (k < maxIters .AND. e >= eMin .AND. T > stopTemp)
	  newX = neighFnc(nParams,lowerBounds,upperBounds)
	  eNew = energyFnc(newX)
	  if (eNew < eBest) 
	   eBest = eNew
	   e = eNew
	   xVec = newX	 
	  else if((rand(1)< exp((e-eNew)/(k*T))))
	   eBest = eNew
	   e = eNew
	   xVec = newX
	  end if
	  k = k+1
	  T = cooling_sched*T
	 end do
	ret(1) = eBest
	ret(2) = xVec(1)
	ret(3) = xVec(2)
end subroutine runSA

